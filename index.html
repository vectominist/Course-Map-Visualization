<html>

<head>
  <!-- <h1>Linear Algebra 2020 Fall Course Map</h1>
  <h2>Prof. <a href="http://speech.ee.ntu.edu.tw/~tlkagk/index.html">Hung-yi Lee</a><br></h2> -->
</head>

<body>
  <!-- START SIGMA IMPORTS -->
  <script src="src/sigma.core.js"></script>
  <script src="src/conrad.js"></script>
  <script src="src/utils/sigma.utils.js"></script>
  <script src="src/utils/sigma.polyfills.js"></script>
  <script src="src/sigma.settings.js"></script>
  <script src="src/classes/sigma.classes.dispatcher.js"></script>
  <script src="src/classes/sigma.classes.configurable.js"></script>
  <script src="src/classes/sigma.classes.graph.js"></script>
  <script src="src/classes/sigma.classes.camera.js"></script>
  <script src="src/classes/sigma.classes.quad.js"></script>
  <script src="src/classes/sigma.classes.edgequad.js"></script>
  <script src="src/captors/sigma.captors.mouse.js"></script>
  <script src="src/captors/sigma.captors.touch.js"></script>
  <script src="src/renderers/sigma.renderers.canvas.js"></script>
  <script src="src/renderers/sigma.renderers.webgl.js"></script>
  <script src="src/renderers/sigma.renderers.svg.js"></script>
  <script src="src/renderers/sigma.renderers.def.js"></script>
  <script src="src/renderers/webgl/sigma.webgl.nodes.def.js"></script>
  <script src="src/renderers/webgl/sigma.webgl.nodes.fast.js"></script>
  <script src="src/renderers/webgl/sigma.webgl.edges.def.js"></script>
  <script src="src/renderers/webgl/sigma.webgl.edges.fast.js"></script>
  <script src="src/renderers/webgl/sigma.webgl.edges.arrow.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.labels.def.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.hovers.def.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.nodes.def.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.edges.def.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.edges.curve.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.edges.arrow.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.edges.curvedArrow.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.edgehovers.def.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.edgehovers.curve.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.edgehovers.arrow.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.edgehovers.curvedArrow.js"></script>
  <script src="src/renderers/canvas/sigma.canvas.extremities.def.js"></script>
  <script src="src/renderers/svg/sigma.svg.utils.js"></script>
  <script src="src/renderers/svg/sigma.svg.nodes.def.js"></script>
  <script src="src/renderers/svg/sigma.svg.edges.def.js"></script>
  <script src="src/renderers/svg/sigma.svg.edges.curve.js"></script>
  <script src="src/renderers/svg/sigma.svg.labels.def.js"></script>
  <script src="src/renderers/svg/sigma.svg.hovers.def.js"></script>
  <script src="src/middlewares/sigma.middlewares.rescale.js"></script>
  <script src="src/middlewares/sigma.middlewares.copy.js"></script>
  <script src="src/misc/sigma.misc.animation.js"></script>
  <script src="src/misc/sigma.misc.bindEvents.js"></script>
  <script src="src/misc/sigma.misc.bindDOMEvents.js"></script>
  <script src="src/misc/sigma.misc.drawHovers.js"></script>
  <!-- END SIGMA IMPORTS -->
  <script src="plugins/sigma.parsers.json/sigma.parsers.json.js"></script>
  <script src="plugins/sigma.plugins.filter/sigma.plugins.filter.js"></script>
  <link href='http://fonts.googleapis.com/css?family=Lato:300,700' rel='stylesheet' type='text/css'>

  <div id="container">
    <style>
      body {
        color: #333;
        font-size: 14px;
        font-family: Lato, sans-serif;
      }

      #graph-container {
        top: 20;
        bottom: 20;
        left: 20;
        right: 220;
        position: absolute;
      }

      #control-pane {
        top: 10px;
        /*bottom: 10px;*/
        right: 10px;
        position: absolute;
        width: 230px;
        background-color: rgb(249, 247, 237);
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
      }

      #control-pane>div {
        margin: 10px;
        overflow-x: auto;
      }

      .line {
        clear: both;
        display: block;
        width: 100%;
        margin: 0;
        padding: 12px 0 0 0;
        border-bottom: 1px solid #000;
        background: transparent;
      }

      h2,
      h3,
      h4 {
        padding: 0;
        /* font-variant: small-caps; */
      }

      .green {
        color: #437356;
      }

      h2.underline {
        color: #000;
        background: #f4f0e4;
        margin: 0;
        border-radius: 2px;
        padding: 8px 12px;
        font-weight: 700;
      }

      .hidden {
        display: none;
        visibility: hidden;
      }

      input[type=range] {
        width: 160px;
      }
    </style>
    <div id="graph-container"></div>
    <div id="control-pane">
      <h2 class="underline">Linear Algebra 2020</h2>
      <!-- <div>
            <h3>min degree <span id="min-degree-val">0</span></h3>
            0 <input id="min-degree" type="range" min="0" max="0" value="0"> <span id="max-degree-value">0</span><br>
        </div> -->
      <div>
        <h3>Prof. <a href="http://speech.ee.ntu.edu.tw/~tlkagk/index.html">Hung-yi Lee</a></h3>
        <h3>Chapter Selection Filter</h3>
        <select id="node-category">
          <option value="" selected>All</option>
        </select>
      </div>
      <!-- <span class="line"></span> -->
      <div>
        <button id="reset-btn">Reset filters</button>
        <!-- <button id="export-btn">Export</button> -->
      </div>
      <!-- <span class="line"></span> -->
      <div>
        <h3>How to use this?</h3>
        1. Drag or zoom in/out with your mouse to watch the course map.<br>
        2. Find chapters with the filter.<br>
        3. Click the nodes to watch course videos.
      </div>
      <span class="line"></span>
      <div>
        Source code: <a href="https://github.com/vectominist/Course-Map-Visualization">github</a><br>
        Powered by <a href="http://sigmajs.org/">Sigma.js</a>
      </div>
      <div id="dump" class="hidden"></div>
    </div>
  </div>
  <script>

    /**
     * This is an example on how to use sigma filters plugin on a real-world graph.
     */
    var filter;

    /**
     * DOM utility functions
     */
    var _ = {
      $: function (id) {
        return document.getElementById(id);
      },

      all: function (selectors) {
        return document.querySelectorAll(selectors);
      },

      removeClass: function (selectors, cssClass) {
        var nodes = document.querySelectorAll(selectors);
        var l = nodes.length;
        for (i = 0; i < l; i++) {
          var el = nodes[i];
          // Bootstrap compatibility
          el.className = el.className.replace(cssClass, '');
        }
      },

      addClass: function (selectors, cssClass) {
        var nodes = document.querySelectorAll(selectors);
        var l = nodes.length;
        for (i = 0; i < l; i++) {
          var el = nodes[i];
          // Bootstrap compatibility
          if (-1 == el.className.indexOf(cssClass)) {
            el.className += ' ' + cssClass;
          }
        }
      },

      show: function (selectors) {
        this.removeClass(selectors, 'hidden');
      },

      hide: function (selectors) {
        this.addClass(selectors, 'hidden');
      },

      toggle: function (selectors, cssClass) {
        var cssClass = cssClass || "hidden";
        var nodes = document.querySelectorAll(selectors);
        var l = nodes.length;
        for (i = 0; i < l; i++) {
          var el = nodes[i];
          //el.style.display = (el.style.display != 'none' ? 'none' : '' );
          // Bootstrap compatibility
          if (-1 !== el.className.indexOf(cssClass)) {
            el.className = el.className.replace(cssClass, '');
          } else {
            el.className += ' ' + cssClass;
          }
        }
      }
    };

    function updatePane(graph, filter) {
      // get max degree
      var maxDegree = 0,
        categories = {};

      // read nodes
      graph.nodes().forEach(function (n) {
        // maxDegree = Math.max(maxDegree, graph.degree(n.id));
        categories[n.attributes.acategory] = true;
      });

      // node category
      var nodecategoryElt = _.$('node-category');
      Object.keys(categories).forEach(function (c) {
        var optionElt = document.createElement("option");
        optionElt.text = c;
        nodecategoryElt.add(optionElt);
      });

      // reset button
      _.$('reset-btn').addEventListener("click", function (e) {
        _.$('node-category').selectedIndex = 0;
        filter.undo().apply();
        // _.$('dump').textContent = '';
        // _.hide('#dump');
      });

    }

    sigma.parsers.json('data/data.json', {
      container: 'graph-container',
      settings: {
        defaultNodeColor: '#ec5148',
        defaultLabelSize: 20,
        minArrowSize: 8,
        minEdgeSize: 1,
        maxEdgeSize: 4,
        sideMargin: 1.2,
        touchEnabled: true,
        doubleClickEnabled: false,
        zoomMin: 0.4,
        zoomMax: 2,
        enableEdgeHovering: true
      },
      renderer: {
        container: document.getElementById('graph-container'),
        type: sigma.renderers.canvas
      }
    },
      function (s) {
        // Click node response: open new window
        s.bind('clickNode', function (e) {
          var win = window.open(e.data.node.url);
          win.focus();
        });
        // Initialize the Filter API
        filter = new sigma.plugins.filter(s);

        updatePane(s.graph, filter);

        function applyCategoryFilter(e) {
          var c = e.target[e.target.selectedIndex].value;
          filter
            .undo('node-category')
            .nodesBy(function (n) {
              return !c.length || n.attributes.acategory === c;
            }, 'node-category')
            .apply();
        }

        _.$('node-category').addEventListener("change", applyCategoryFilter);
      });
  </script>
</body>

</html>